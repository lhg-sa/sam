[
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 0,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Insert",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-10-08 22:46:38.194049",
  "module": "SAM",
  "name": "customer_script_server",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Customer",
  "script": "# Force Customer naming with series C-#####\r\ndef get_next_customer_number():\r\n    \"\"\"Get next number in C-##### series\"\"\"\r\n    # Query the last customer with C- prefix\r\n    last_customer = frappe.db.sql(\"\"\"\r\n        SELECT name \r\n        FROM `tabCustomer` \r\n        WHERE name LIKE 'C-%' \r\n        ORDER BY creation DESC \r\n        LIMIT 1\r\n    \"\"\", as_dict=True)\r\n    \r\n    if last_customer:\r\n        # Extract number from C-00001 format\r\n        last_name = last_customer[0].name\r\n        try:\r\n            last_number = int(last_name.split('-')[1])\r\n            next_number = last_number + 1\r\n        except:\r\n            next_number = 1\r\n    else:\r\n        next_number = 1\r\n    \r\n    # Format as C-00001\r\n    return f\"C-{next_number:05d}\"\r\n\r\n# Set the name\r\nif not doc.name or doc.name.startswith(\"new-customer\"):\r\n    doc.name = get_next_customer_number()",
  "script_type": "DocType Event"
 }
]